{%- assign lang = page.lang -%}
{%- if lang == nil -%}{%- assign lang = site.lang -%}{%- endif -%}
{%- if lang == "" -%}{%- assign lang = "ja" -%}{%- endif -%}

{%- assign theme_key = page.theme -%}
{%- if theme_key == nil or theme_key == "" -%}{%- assign theme_key = "center" -%}{%- endif -%}
{%- assign t = site.data.themes[theme_key] -%}

<!doctype html>
<html lang="{{ lang }}">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{{ page.title }} | {{ site.title }}</title>
  <meta name="theme-color" content="{{ t.bg }}">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Noto+Sans+JP:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="{{ '/assets/css/main.css' | relative_url }}">
  <style>
    :root{
      --bg: {{ t.bg | default: '#000000' }};
      --surface: {{ t.surface | default: 'rgba(0,0,0,0.82)' }};
      --ink: {{ t.ink | default: '#ffffff' }};
      --primary: {{ t.primary | default: '#ffffff' }};
      --secondary: {{ t.secondary | default: '#b3c0ff' }};
      --radius: {{ site.data.themes.base.radius }};
      --font-jp: {{ site.data.themes.base.font_jp | jsonify }};
      --font-en: {{ site.data.themes.base.font_en | jsonify }};
    }
    html, body {
      background: var(--bg);
      color: var(--ink);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      transition: none;
    }
    /* Prevent fixed nav from overlapping content */
    body { padding-top: 64px; }
    .nav-wrap {
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .brand {
      margin-right: auto;
      display: flex;
      align-items: center;
      gap: 0.6rem;
    }
    .site-title {
      font-weight: 700;
      font-size: 1.1rem;
      color: var(--ink);
      white-space: nowrap;
    }
    @media (max-width: 768px) {
      .site-title {
        font-size: 1rem;
      }
    }
    .nav-controls{ display:flex; align-items:center; gap:.75rem; margin-left:auto; }
  </style>
</head>
<body>
  <a class="skip-link" href="#main">Skip to content</a>
  <header class="site-nav" role="banner">
    <div class="nav-wrap">
      <a class="brand" href="{{ '/' | relative_url }}" aria-label="Center Home">
        <span class="site-title">量子未来社会デザイン研究センター</span>
        {%- if site.logo -%}
          <img src="{{ site.logo | relative_url }}" alt="logo" width="28" height="28" />
        {%- endif -%}
      </a>

      {% include nav.html theme_key=theme_key %}
    </div>
  </header>
  <main id="main" class="container">
    {{ content }}
  </main>
  <footer class="site-footer">
    <div class="container">
      <small>© {{ "now" | date: "%Y" }} {{ site.title }}</small>
    </div>
  </footer>
  <script src="{{ '/assets/js/general.js' | relative_url }}" defer></script>
</body>
</html>