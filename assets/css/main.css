/* Base */
html,body{background:var(--bg);color:var(--ink);
  font-family:var(--font-en),var(--font-jp),system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial;
  line-height:1.6; font-size:16px}
body { padding-top: 64px; }
*{box-sizing:border-box}
img{max-width:100%;height:auto}
a{color:var(--primary);text-underline-offset:2px}
h1,h2,h3{line-height:1.3;margin:1.4rem 0 .6rem}
.container{max-width:1100px;margin:0 auto;padding:1rem}
.card{background:var(--surface);border-radius:var(--radius);
  box-shadow:0 6px 18px rgba(0,0,0,.12);transition:.18s;padding:1rem}
.card:hover{transform:translateY(-1px);box-shadow:0 10px 24px rgba(0,0,0,.18)}
.btn{display:inline-flex;align-items:center;gap:.4rem;background:var(--primary);color:#091018;
  border-radius:var(--radius);padding:.6rem .9rem;text-decoration:none;font-weight:600}
.hx{position:relative;padding-bottom:.25rem;display:inline-block}
.hx::after{content:"";position:absolute;left:0;bottom:0;width:64px;height:2px;
  background:linear-gradient(90deg,#fff,transparent)}

/* Skip */
.skip-link{position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden}
.skip-link:focus{left:12px;top:8px;width:auto;height:auto;background:var(--secondary);color:#fff;padding:.4rem .6rem;border-radius:8px;z-index:10000}

/* Nav */
.site-nav{
  position:fixed; top:-8px; left:0; right:0; z-index:999;
  backdrop-filter:saturate(140%) blur(10px);
  background: color-mix(in hsl, var(--bg) 90%, transparent);
  border-bottom:1px solid color-mix(in srgb, #ffffff 28%, transparent);
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
  padding: 0.5rem 0;
  height: 64px;
  display: flex;
  align-items: center;
}

.nav-wrap{
  max-width:1200px; margin:0 auto; padding:0 1rem;
  display:flex; align-items:center; justify-content:space-between; gap:.75rem;
  height: 100%;
}
.brand{display:inline-flex; align-items:center; gap:.6rem; text-decoration:none}
.brand-text{color:var(--ink); font-weight:600; letter-spacing:.2px}

.menu-toggle{
  display:inline-flex; align-items:center; gap:.4rem;
  border:1px solid color-mix(in srgb, var(--ink) 20%, transparent);
  background:var(--surface); color:var(--ink); border-radius:12px; padding:.4rem .6rem;
}
.menu-toggle:focus-visible{outline:2px solid var(--secondary); outline-offset:2px}

.nav-controls{
  display:flex; align-items:center; gap:1.2rem;
  flex: 1 1 auto;           /* allow this area to shrink/expand */
  min-width: 0;             /* enable child flex items to shrink */
  justify-content: flex-end;/* push links to the right within available space */
}
#nav-links{
  flex: 1 1 auto;           /* take remaining width */
  min-width: 0;             /* avoid overflow */
}
#nav-links ul{
  display:flex; align-items:center; gap:.25rem; list-style:none; margin:0; padding:0;
  flex-wrap: wrap;          /* allow wrapping on desktop */
  justify-content: flex-end;/* align to right when wrapping */
}
.nav-link{display:inline-flex; align-items:center; padding:.55rem .8rem; border-radius:12px; text-decoration:none;
  color:var(--ink); border:1px solid transparent}
.nav-link:hover {
  background: color-mix(in srgb, var(--surface) 92%, #ffffff 8%);
  border: 1px solid #ffffff;
}
.nav-link.is-active{border-color:color-mix(in srgb, #ffffff 45%, transparent)}

.nav-link.cta{background:transparent; color:var(--ink); font-weight:600}
.nav-link.cta:hover{background: color-mix(in srgb, var(--surface) 92%, #ffffff 8%); border: 1px solid #ffffff}

.lang{margin-left:.6rem}
.lang-btn{display:inline-flex; align-items:center; padding:.46rem .7rem; border-radius:10px;
  border:1px solid color-mix(in srgb, var(--ink) 18%, transparent); text-decoration:none; color:var(--ink)}

@media (max-width: 960px){
  .menu-toggle{display:inline-flex}
}
@media (min-width: 961px){
  .menu-toggle{display:none}
}

header.site-nav li,
#nav-links li {
  opacity: 1 !important;
  transform: none !important;
  transition: none !important;
}

/* Footer */
.site-footer{border-top:1px solid color-mix(in srgb, #ffffff 20%, transparent); margin-top:2rem;padding:1.2rem 0;opacity:.9}

/* === Nav layout refinements (brand flush-left, consistent theming) === */
.nav-wrap{ justify-content:flex-start; }
.brand{ margin-right:auto; display:flex; align-items:center; gap:.6rem; }
.site-title{ font-weight:700; font-size:1.1rem; color:var(--ink); letter-spacing:.02em; white-space:nowrap }
.brand-text{ position:absolute; left:-9999px; width:1px; height:1px; overflow:hidden } /* keep for SR */

/* Overlay menu panel styles (dark theme; avoid white flash) */
#nav-links{
  background: var(--surface) !important;
  color: var(--ink) !important;
  border: 1px solid color-mix(in srgb, #ffffff 18%, transparent);
  border-radius: 12px;
  box-shadow: 0 14px 40px rgba(0,0,0,.35);
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  max-height: calc(100vh - 24px);
}
/* Overlay state: emphasize panel with white border */
.nav-open #nav-links{
  background: var(--surface) !important;
  border: 2px solid rgba(255,255,255,0.95) !important; /* 白枠 */
  box-shadow: 0 18px 48px rgba(0,0,0,.45);
}

/* Ensure overlay panel is always above everything and fully visible */
.nav-open #nav-links{
  position: fixed !important;
  z-index: 2147483647 !important; /* top-most */
  top: max(12px, env(safe-area-inset-top));
  right: max(12px, env(safe-area-inset-right));
  left: auto !important;
  width: min(250px, 88vw);
  max-height: calc(100vh - max(24px, env(safe-area-inset-top)) - max(24px, env(safe-area-inset-bottom)));
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  padding-bottom: max(12px, env(safe-area-inset-bottom));
  border-radius: 12px;
  isolation: isolate; /* avoid parent stacking/clip issues */
}
.nav-open .site-nav{ z-index: 100 !important; } /* keep header below the panel */
.nav-open .nav-backdrop{
  position: fixed !important;
  inset: 0 !important;
  z-index: 2147483646 !important; /* just below panel */
  pointer-events: auto !important;
}

/* Keep menu/backdrop always on top when open */
.nav-open #nav-links, .nav-backdrop{ z-index: 2147483647 !important; }

/* Small screens: keep title readable and menu toggle on the right */
@media (max-width: 768px){
  .site-title{ font-size:1rem }
  .menu-toggle{ margin-left:auto }
}
/* --- Force brand flush-left / links to the right --- */
.site-nav .nav-wrap{
  justify-content: flex-start !important;
  max-width: none !important;   /* コンテナ幅の上限を解除 */
  width: 100% !important;
  margin: 0 !important;
  padding-left: 0 !important;   /* 左余白をゼロに */
  padding-right: 16px;          /* 右だけ少し余白 */
}
.site-nav .brand{
  order: 0;
  margin-right: auto !important;  /* これで brand が左端に張り付く */
  display: flex;
  align-items: center;
  gap: .6rem;
  margin-left: max(0px, env(safe-area-inset-left)) !important;
  flex: 0 0 auto !important;
}
.site-nav .brand .site-title{
  display: inline-block;
  font-weight: 700;
  font-size: 1.1rem;
  color: var(--ink);
  white-space: nowrap;
  margin-left: 8px;
}
.site-nav .menu-toggle{ order: 1; margin-left: 12px; }
.site-nav #nav-links{ order: 2; }

.nav-controls{ margin-left:auto }

/* デスクトップ時はインライン配置（オーバーレイ無効） */
@media (min-width: 960px){
  #nav-links{
    position: static !important;
    display: block !important;
    background: transparent !important;
    color: var(--ink) !important;
    border: 0 !important;
    box-shadow: none !important;
    max-height: none !important;
    overflow: visible !important;
  }
  .nav-open #nav-links{ position: fixed !important; } /* safety for edge cases */
  #nav-links .nav-link{ color: var(--ink) !important; border-color: transparent; }
}

/* モバイルでの可読性 */
@media (max-width: 768px){
  .site-nav .brand .site-title{ font-size: 1rem; }
  .site-nav .links{ border-left: none; margin-left: 0; padding-left: 0; }
}